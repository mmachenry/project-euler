import List

-- Incrementally largest values of minimal x satisfying
-- Pell equation x^2-Dy^2=1. (http://oeis.org/A033315)
a033315 = [
  1
 ,3
 ,9
 ,19
 ,649
 ,9801
 ,24335
 ,66249
 ,1766319049
 ,158070671986249
 ,2469645423824185801
 ,159150073798980475849
 ,838721786045180184649
 ,25052977273092427986049
 ,3879474045914926879468217167061449
 ,3707453360023867028800645599667005001
 ,16421658242965910275055840472270471049
 ,198723867690977573219668252231077415636351801801
 ,742925865816843150858935268959512942700219559049
 ,91889645003972654622127399341267476203024769394634584316300287049
 ,48106848972197087743588687481413975084698632248110750633952591202305801
 ,6298101812493732343034974500091457815529942308667051412857352310169665125001
 ,306337641617643341027085710770455942914371640417170871093925283234950306862032993601801
 ,112530121023358898404903532500783683343457018270681330586871060096531509537062002479141495461904563645449
 ,69064617233461095705502618958276098458812682946789125635506295686486580975895811181872804933779895541138006805001
 ,8784966228052956337831539614153017127496883947504004927423017979424284055063479878882987198859573520634598388198267578873801
 ,374308098275810082115773788370209230330090529219031272239912553103131951745022736992360918617477763508328965455430279885758005001
 ,12165098448733217042597100360612188326460959169855150084680319775011277825702423512631542892425581209064381496987460168611374494519049
 ,5065413492004297293786670834239563360976354660700338075717614515045512437839424930580187005697127012583859257537495240624926470730836038037349449
 ,1365272745009446927557458948503207868718482202717192507811330581145572975975879788390509993060830389454180014161550958739476599661930128781996135795071049
 ,329193470472193712949550776348318404515010693082347229388317940707942971956588011161803916649277857045856156953356297825072563425494288962207368895353723748671049
 ,33062619115498415354672956090445328468427948652304945487550872739650291167548601953034995310740662490641188621406246998934867492994207172774777121423359925276149434261449
 ,2565007112872132129669406439503954211359492684749762901360167370740763715001557789090674216330243703833040774221628256858633287876949448689668281446637464359482677366420261407112316649010675881349744201
 ,23551019614858223475933893515741198183163217312913587552899320396564478041197360918469501097146448985821854465768234479384482435117587576296319428592757548743265811454938493105633433315887574461850060798834186249
 ,17769290889606424307391613475710815922663764278687506160595570798447867338183351362937367370654641944727366169008187412340924600349159096958294579896274216146658427912799441048288970291371704379296154452991192453881337900313229848065801
 ,2811757713163109418718287759661506187481467133578690478316634459673085017209466738670983636195035329921016645349007696053749287054004622622727455206250602802402900618491250413723458622250958694479065506145478004909336829066810477337375136532167906352989449
 ,987678914739315906309390706102429332346508314527139109895219333915510327875993002425828726478577797417521200487352920791657251426589603386511980883153663810965996934345787484167145744187812909104044592888175599809325312627416518165808329074249863855275874631049
 ,81887676936210939197797903931847580410468849545875638045132141892699368760495749878780996203044381390166194841745994774349874560460240508809114948323796270551250394587849728371822001134403114506175468495377695679317299769935725124744992715267748691011204854457386224483426645001
 ,19858986107847514355359749359856759532231643879731601747518020029650069964882058582668026452219826865838464386216797353583081977164220916722502400474829429531261387042524815758134559841080972272093673104833820848291472309812816388897202426349331941286418343756991906137422407196449
 ,344744167764505432598906346557730413507904689711620599564778967224982620817200797959064049415224583866578713550158743772313402321308779543436103755345666145762313529668428259279777428109892700363641700791679041361358343138115023219684113682811447428556198796183059145287979403366984087693978824167975049
 ,1445004890248867833146640551287685612295924494993988435652932871719294043329745377398033235773241748507817325268246282336628156404506644443081309623775378176826918452948328873746256903610944511422341604631619661537037158699131894818684587198095407259120888760573760977141732988026361790990331508911757583583015340623464832167049
 ,505619755878294714028800094090708025797245268358752245269663217402892650883325421032186918670446106059062240584665872837389309508916166156309323943128145415509998184715092624092160673699611801907989286487530838967062983391063329289492137150753065158993645387194719524931323387521540597608741539865778066868762436111317369350240201
 ,1161062250963777359012049450338847929268387101906341233109730747794395050722746581940699875505437859169898637863541591179335007883970238325027529224308437179378982447096804550030189145527235597020981349440664787675766638893535512212282432766150437081350545951147735058877403875291746457696643224395444582177269886650793664078128685165133293522576810967311205001
 ,1417270421104979455142001664178632739580912568371340307392508654956805707206316628361916391685454267483740335495524483877363543185718429281542354446488324796732464569785412088685835312287760323740568525867474663314762555546539368543067446866221457798639818109657792168957026574554717310018086776092020511931606095480455183597098447147024800248880835047521463649193117554052574763433982105887049
 ,231446625469330547063653466380341650884768415567920847120798664518358126368924132836346754515774790386772530815313607071647252706791491970256814437146455834947553996272180066550370609346023922429497967074555308419257185733092605620947616443018734049595421511838831572971889789472830615589210733725955297122467621706874211608495667020868356856433380951838566277999358873515617529778484190283045449
 ,11014531262071775139254857546254470587809492269499820687249462076724901879133968567573112006797369650685219620230182197005239472938348898948646187246351773125262466634425365325961551264697038934743273358781893695496147313054339601531409703779999804490704281688605707014759622883606167011136045065471332108397000481701104735716607340405235792954772896839522157297234609767206096169312297932192591384646779247672017914511529776087381817374768317586249
 ,5755008416710676261583711126314182721008718672761447650635605013444755476088672373796245209006880889041483900561807391580233751140460856022744016853998623550729417027586100219431546678975050654150402137591796830632062503566443181238351513571554047657837339590065557647979052023185460524305854903956020802987440551427488778958809745305465633034586062260363976545034566360521144134225918879957464067686319342517894450788143219207452553220775438546296201
 ,3599406615419249949371912972948700705683894647597990048097192351357039354552500249170910850552576564526041498358970961109149956677467622540012103843853857182824018738904380461990275386611301371777531683412127206715668604888697178196416178110767131111778985246711308407949647633871497637644178917996147579979349838248310536392934086649220537507547619177941931425954510240626440626127897117832318498178938968579665031831025954338312085215908830015937185053557007118396813730226249
 ,571279204895522836889516469340468552394802510380623322780331385611163032289334620631326681568669652828212709569558370513197912904962328370667152958454986727642860630150792467758359995765218824702353978276264065625639808115949799887832801550800277319565552679635086955109731836930020890052657048457841184594398798041363234632216712100172541859256021024600587823210139953703248081374581938316616659507108749676581195501482412308411575791846488015061592008216989561105750365050765378257470934917191787562030535049
 ,332223115628002243876947250024495811733226483903055951645260474767094641152715915535350632453120447885531365119186618865628058710776912786662699303096211332551147715787418803548678212807472440836962576224603847978027891155122832583798331851883737029976535131924920850295706392385333164923828526290392887974077086501871400979071448777182681140036396260588368799702102493677225107418460972908982606420844491761125278848799146176700775478048323702793241606117051831483898155403800293847511237603542935408515869037455904233441801
  ]

intSqrt :: Integral a => a -> a
intSqrt n
    | n <= 0 = error "Not positive int"
    | otherwise = f n
    where f x = if y < x then f y else x
            where y = (x + (n `quot` x)) `quot` 2

isSquare n = n == (intSqrt n) ^ 2
divides d n = n `mod` d == 0
findD x = find (solves x) [2..1000]
solves x d = divides d (x*x-1) && isSquare ((x*x-1) `quot` d)
solution = findSolution (map findD (drop 1 a033315))
    where findSolution [] = error "You need more numbers from a033315"
          findSolution (Just d:Nothing:_) = d 
          findSolution (_:rest) = findSolution rest
